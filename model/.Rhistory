analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
source("./MasterModel.R")
s_fund <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
s_fund <- Sys.time()
det_SQ_recur_recession <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.7,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund <- Sys.time()
e_fund - s_fund
source("./MasterModel.R")
s_fund <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund <- Sys.time()
e_fund - s_fund
s_fund_ <- Sys.time()
det_SQ_recur_recession <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.7,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund_ <- Sys.time()
e_fund_ - s_fund_
source("./MasterModel.R")
s_fund <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund <- Sys.time()
View(det_SQ_assumption)
e_fund - s_fund
credited_interest_
s_fund_ <- Sys.time()
det_SQ_recur_recession <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.7,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund_ <- Sys.time()
View(det_SQ_recur_recession)
View(det_SQ_assumption)
e_fund_ - s_fund_
salary_projection <-
expand_grid(
entry_year = entry_year_range,
entry_age = all_entry_age,
yos = yos_range) %>%
mutate(
age = entry_age + yos,
year = entry_year + yos) %>%
filter(age <= max_age) %>%
arrange(entry_year, entry_age, yos) %>%
select(entry_year, entry_age, age, yos, year) %>%
left_join(salary_entry, by = "entry_age") %>%
left_join(salary_growth_rate, by = "yos") %>%
group_by(entry_year, entry_age) %>%
mutate(
salary = start_salary * cumprod(1 + lag(salary_growth_rate, default = 0)) * (1 + payroll_growth_)^(year - yos - year_start),
fas_year = 4,
final_avg_salary = get_roll_mean(salary, fas_year), # fix FAS at 4
employee_contribution = ee_contr_rate_ * salary,
db_employee_balance = get_cum_fv(credited_interest_, employee_contribution),
) %>%
ungroup() %>%
replace(is.na(.), 0)
setDT(salary_projection)
View(salary_projection)
get_salary_projection <- function(salary_entry, salary_growth_rate){
salary_projection <-
expand_grid(
entry_year = entry_year_range,
entry_age = all_entry_age,
yos = yos_range) %>%
mutate(
age = entry_age + yos,
year = entry_year + yos) %>%
filter(age <= max_age) %>%
arrange(entry_year, entry_age, yos) %>%
select(entry_year, entry_age, age, yos, year) %>%
left_join(salary_entry, by = "entry_age") %>%
left_join(salary_growth_rate, by = "yos") %>%
group_by(entry_year, entry_age) %>%
mutate(
salary = start_salary * cumprod(1 + lag(salary_growth_rate, default = 0)) * (1 + payroll_growth_)^(year - yos - year_start),
fas_year = 4,
final_avg_salary = get_roll_mean(salary, fas_year), # fix FAS at 4
employee_contribution = ee_contr_rate_ * salary,
db_employee_balance = get_cum_fv(credited_interest_, employee_contribution),
) %>%
ungroup() %>%
replace(is.na(.), 0)
setDT(salary_projection)
}
salary_projection_ <- get_salary_projection(salary_entry, salary_growth_rate)
View(salary_projection_)
source("./MasterModel.R")
s_fund <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
source("./MasterModel.R")
s_fund <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
salary_projection_ <- get_salary_projection_memo(salary_entry, salary_growth_rate)
is.data.table(salary_projection_)
source("./MasterModel.R")
s_fund <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund <- Sys.time()
View(det_SQ_assumption)
e_fund - s_fund
s_fund_ <- Sys.time()
det_SQ_recur_recession <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.039,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund_ <- Sys.time()
e_fund_ - s_fund_
s_fund_ <- Sys.time()
det_SQ_recur_recession <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.039,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund_ <- Sys.time()
View(det_SQ_recur_recession)
s_fund_ <- Sys.time()
det_SQ_recur_recession <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund_ <- Sys.time()
View(det_SQ_recur_recession)
source("./MasterModel.R")
s_fund <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund <- Sys.time()
View(det_SQ_assumption)
e_fund - s_fund
s_fund_ <- Sys.time()
det_SQ_recur_recession <-  memoised_get_funding_data(
curr_disc_rate = 0.07,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund_ <- Sys.time()
View(det_SQ_recur_recession)
e_fund_ - s_fund_
s_fund_ <- Sys.time()
det_SQ_recur_recession <-  memoised_get_funding_data(
curr_disc_rate = 0.07,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.69,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund_ <- Sys.time()
View(det_SQ_recur_recession)
e_fund_ - s_fund_
s_fund_ <- Sys.time()
det_SQ_recur_recession <- memoised_get_funding_data(
curr_disc_rate = 0.07,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.69,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "RecurringRecession"
)
e_fund_ <- Sys.time()
e_fund_ - s_fund_
View(det_SQ_recur_recession)
library(plumber)
r <- plumb("plumber.R")
r$run(port=80, host="0.0.0.0")
rm(list = ls())
library("readxl")
library(dplyr)
library(tidyr)
library(zoo)
library(ggplot2)
library(data.table)
library(openxlsx)
library(data.table)
library(Rcpp)
library(memoise)
s_time <- Sys.time()
source("./UtilityFunctions.R")
source("./Inputs.R")
sourceCpp("./future_value_cpp.cpp")
source("./BenefitModel.R")
source("./WorkforceModel.R")
# get_wf_data()
wf_projection <- readRDS("./wf_data.rds")
source("./LiabilityModel.R")
source("./FundingModel.R")
m_time <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_time <- Sys.time()
e_time - m_time
m_time - s_time
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.039,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
rm(list = ls())
library("readxl")
library(dplyr)
library(tidyr)
library(zoo)
library(ggplot2)
library(data.table)
library(openxlsx)
library(data.table)
library(Rcpp)
library(memoise)
s_time <- Sys.time()
source("./UtilityFunctions.R")
source("./Inputs.R")
sourceCpp("./future_value_cpp.cpp")
source("./BenefitModel.R")
source("./WorkforceModel.R")
# get_wf_data()
wf_projection <- readRDS("./wf_data.rds")
source("./LiabilityModel.R")
source("./FundingModel.R")
m_time <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_time <- Sys.time()
m_time - s_time
e_time - m_time
m_time <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_time <- Sys.time()
m_time <- Sys.time()
det_SQ_assumption <-  memoised_get_funding_data(
curr_disc_rate = 0.0755,
new_disc_rate = 0.0755,
cola = 0.039,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_time <- Sys.time()
e_time - m_time
base_benefit_data <- get_benefit_data(
curr_discount_rate = 0.0755,
new_discount_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6
)
source("./MasterModel.R")
base_benefit_data <- get_benefit_data(
curr_discount_rate = 0.0755,
new_discount_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6
)
base_benefit_data$nc_agg
base_liability_data <- get_liability_data(
curr_discount_rate = 0.0755,
new_discount_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6
)
View(base_liability_data)
det_SQ_assumption <-  get_funding_data(
curr_discount_rate = 0.0755,
new_discount_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
View(det_SQ_assumption)
s_fund <- Sys.time()
det_SQ_assumption <-  get_funding_data(
curr_discount_rate = 0.07,
new_discount_rate = 0.07,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund <- Sys.time()
e_fund - s_fund
s_fund <- Sys.time()
det_SQ_assumption <-  get_funding_data(
curr_discount_rate = 0.0755,
new_discount_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund <- Sys.time()
source("./MasterModel.R")
s_fund <- Sys.time()
det_SQ_assumption <-  get_funding_data(
curr_discount_rate = 0.0755,
new_discount_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
e_fund <- Sys.time()
View(det_SQ_assumption)
base_liability_data <- get_liability_data(
curr_discount_rate = 0.0755,
new_discount_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6
)
View(base_liability_data)
source("./MasterModel.R")
det_SQ_assumption <-  get_funding_data(
curr_dist_rate = 0.0755,
new_dist_rate = 0.0755,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
det_SQ_assumption$cum_total_hire_ER_contr_real
det_SQ_assumption$total_hire_ual_mva_real
det_SQ_assumption$total_hire_ER_all_in_cost_real
det_SQ_assumption$total_hire_ER_contr_real
det_SQ_assumption$total_hire_ER_contr_rate
source("./MasterModel.R")
base_benefit_data <- get_benefit_data()
base_liability_data <- get_liability_data()
base_funding_data <- get_funding_data()
View(base_funding_data)
View(base_liability_data)
base_benefit_data$nc_agg
rm(list = ls())
library("readxl")
library(dplyr)
library(tidyr)
library(zoo)
# library(ggplot2)
library(data.table)
library(openxlsx)
library(Rcpp)
# library(memoise)
s_time <- Sys.time()
source("./UtilityFunctions.R")
source("./Inputs.R")
rm(list = ls())
library("readxl")
library(dplyr)
library(tidyr)
library(zoo)
# library(ggplot2)
library(data.table)
library(openxlsx)
library(Rcpp)
# library(memoise)
s_time <- Sys.time()
source("./UtilityFunctions.R")
source("./Inputs.R")
sourceCpp("./future_value_cpp.cpp")
source("./BenefitModel.R")
source("./WorkforceModel.R")
# get_wf_data()
wf_projection <- readRDS("./wf_data.rds")
source("./LiabilityModel.R")
source("./FundingModel.R")
det_SQ_assumption <-  get_funding_data(
curr_dist_rate = 0.07,
new_dist_rate = 0.07,
cola = 0.03,
retire_refund_ratio = 0.6,
funding_policy = "StatusQuo",
analysis_type = "Deterministic",
roa_scenario = "Assumption"
)
View(det_SQ_assumption)
